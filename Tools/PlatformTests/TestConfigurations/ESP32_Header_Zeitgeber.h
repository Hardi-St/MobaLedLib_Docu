// This file contains the DCC and LED definitions.
//
// It was automatically generated by the program Prog_Generator_MobaLedLib.xlsm Ver. 3.1.0A      by Hardi
// File creation: 20.12.2021 11:53:54
// (Attention: The display in the Arduino IDE is not updated if Options/External Editor is disabled)

#ifndef __LEDS_AUTOPROG_H__
#define __LEDS_AUTOPROG_H__

#ifndef ARDUINO_RASPBERRY_PI_PICO
#define FASTLED_INTERNAL       // Disable version number message in FastLED library (looks like an error)
#include <FastLED.h>           // The FastLED library must be installed in addition if you got the error message "..fatal error: FastLED.h: No such file or directory"
                               // Arduino IDE: Sketch / Include library / Manage libraries                    Deutsche IDE: Sketch / Bibliothek einbinden / Bibliothek verwalten
                               //              Type "FastLED" in the "Filter your search..." field                          "FastLED" in das "Grenzen Sie ihre Suche ein" Feld eingeben
                               //              Select the entry and click "Install"                                         Gefundenen Eintrag auswaehlen und "Install" anklicken
#else
#include <PicoFastLED.h>       // Juergens minimum version or FastLED for Raspberry Pico
#endif

#include <MobaLedLib.h>

#define START_MSG "LEDs_AutoProg Ver 1: Ver_3.1.0 20.12.21 11:53"

#define TWO_BUTTONS_PER_ADDRESS 1      // Two buttons (Red/Green) are used (DCC/CAN)
#ifdef NUM_LEDS
  #warning "'NUM_LEDS' definition in the main program is replaced by the included 'LEDs_AutoProg.h' with 50"
  #undef NUM_LEDS
#endif

#define NUM_LEDS 50                    // Number of LEDs (Maximal 256 RGB LEDs could be used)

#define LEDS_PER_CHANNEL ",50"

#define RECEIVE_LED_COLOR_PER_RS232
#define USE_EXT_ADDR
#define USE_RS232_OR_SPI_AS_INPUT      // Use the RS232 or SPI Input to read DCC/SX commands from the second Arduino and from the PC (The SPI is only used if enabled with USE_SPI_COM)
#define ADDR_OFFSET 0

#define ADDR_MSK  0x3FFF  // 14 Bits are used for the Address

#define S_ONOFF   (uint16_t)0
#define B_RED     (uint16_t)(1<<14)
#define B_GREEN   (uint16_t)(2<<14)
#define B_RESERVE (uint16_t)(3<<14)    // Not used at the moment
#define B_TAST    B_RED


typedef struct
    {
    uint16_t AddrAndTyp; // Addr range: 0..16383. The upper two bytes are used for the type
    uint8_t  InCnt;
    } __attribute__ ((packed)) Ext_Addr_T;

// Definition of external adressesconst PROGMEM Ext_Addr_T Ext_Addr[] =         { // Addr & Typ    InCnt
           { 22   + B_RED,   1 },      // Zeitgeber (pc) 0 = 0:00, 239 = 23:59           { 23   + S_ONOFF, 1 },      // Excel row 29           { 24   + S_ONOFF, 1 },      // Excel row 30         };


// Input channel defines for local inputs and expert users
#define INCH_DCC_22_RED         0      // Zeitgeber (pc) 0 = 0:00, 239 = 23:59#define INCH_DCC_23_ONOFF       1      // Excel row 29#define INCH_DCC_24_ONOFF       2      // Excel row 30

//*** Output Channels ***
#define t1                      3
#define t2                      4
#define t3                      5
#define t4                      6
#define t5                      7
#define t6                      8
#define t7                      9
#define t8                      10
#define t9                      11
#define t10                     12
#define t11                     13
#define t12                     14
#define t13                     15
#define t14                     16
#define t15                     17
#define t16                     18
#define t17                     19
#define t18                     20
#define t19                     21
#define t20                     22
#define t21                     23
#define t22                     24
#define t23                     25
#define BlinkerEin              26
#define h18bis23                27
#define h22bis03                28
#define h06bis09                29
#define rand1                   30
#define rand2                   31
#define rand3                   32
#define rand4                   33
#define rand5                   34
#define rand6                   35
#define rand7                   36
#define rand8                   37

/*********************/
#define SETUP_FASTLED()                                                      \
/*********************/                                                      \
  CLEDController& controller0 = FastLED.addLeds<NEOPIXEL, 27>(leds+  0, 50); \
                                                                             \
  controller0.clearLeds(256);                                                \
  FastLED.setDither(DISABLE_DITHER);       // avoid sending slightly modified brightness values
/*End*/

// ----- LED to Var -----
  #define USE_LED_TO_VAR

  #define T_EQUAL_THEN     0
  #define T_NOT_EQUAL_THEN 1
  #define T_LESS_THEN      2
  #define T_GREATER_THAN   3
  #define T_BIN_MASK       4
  #define T_NOT_BIN_MASK   5

  typedef struct
      {
      uint8_t  Var_Nr;
      uint8_t  LED_Nr;
      uint8_t  Offset_and_Typ; // ---oottt    Offset: 0..2
      uint8_t  Val;
      } __attribute__ ((packed)) LED2Var_Tab_T;

  const PROGMEM LED2Var_Tab_T LED2Var_Tab[] =
      {
        // Var name           LED_Nr LED Offset   Typ                Compare value
        { t1,                 1,     (0   << 3) | T_GREATER_THAN,    9   },        { t2,                 1,     (0   << 3) | T_GREATER_THAN,    19  },        { t3,                 1,     (0   << 3) | T_GREATER_THAN,    29  },        { t4,                 1,     (0   << 3) | T_GREATER_THAN,    39  },        { t5,                 1,     (0   << 3) | T_GREATER_THAN,    49  },        { t6,                 1,     (0   << 3) | T_GREATER_THAN,    59  },        { t7,                 1,     (0   << 3) | T_GREATER_THAN,    69  },        { t8,                 1,     (0   << 3) | T_GREATER_THAN,    79  },        { t9,                 1,     (0   << 3) | T_GREATER_THAN,    89  },        { t10,                1,     (0   << 3) | T_GREATER_THAN,    99  },        { t11,                1,     (0   << 3) | T_GREATER_THAN,    109 },        { t12,                1,     (0   << 3) | T_GREATER_THAN,    119 },        { t13,                1,     (0   << 3) | T_GREATER_THAN,    129 },        { t14,                1,     (0   << 3) | T_GREATER_THAN,    139 },        { t15,                1,     (0   << 3) | T_GREATER_THAN,    149 },        { t16,                1,     (0   << 3) | T_GREATER_THAN,    159 },        { t17,                1,     (0   << 3) | T_GREATER_THAN,    169 },        { t18,                1,     (0   << 3) | T_GREATER_THAN,    179 },        { t19,                1,     (0   << 3) | T_GREATER_THAN,    189 },        { t20,                1,     (0   << 3) | T_GREATER_THAN,    199 },        { t21,                1,     (0   << 3) | T_GREATER_THAN,    209 },        { t22,                1,     (0   << 3) | T_GREATER_THAN,    219 },        { t23,                1,     (0   << 3) | T_GREATER_THAN,    229 },        { BlinkerEin,         3,     (2   << 3) | T_GREATER_THAN,    0   },
      };




//*******************************************************************
// *** Configuration array which defines the behavior of the LEDs ***
MobaLedLib_Configuration()
  {
  RGB_Heartbeat(0)                                                                                            /* Excel row 4                                                                                                                                                                                 */  // Activation: N_Buttons1                                                                                   /* Zeitgeber (pc) 0 = 0:00, 239 = 23:59                                                                                                                                                        */  InCh_to_TmpVar1(0, 1)                                                                                       /*     "                                                                                                                                                                                       */  APatternT5(1,28,SI_LocalVar,1,0,239,0,PM_NORMAL,0,0,12 Sek,0,12 Sek,120,120,239,0,120  ,63,192,0,0,1)       /*     "                                                                                                                                                                                       */  // LED_to_Var(t1, 0, >, 9)                                                                                  /* Stunde 1                                                                                                                                                                                    */  // LED_to_Var(t2, 0, >, 19)                                                                                 /* Stunde 2                                                                                                                                                                                    */  // LED_to_Var(t3, 0, >, 29)                                                                                 /* Stunde 3                                                                                                                                                                                    */  // LED_to_Var(t4, 0, >, 39)                                                                                 /* Stunde 4                                                                                                                                                                                    */  // LED_to_Var(t5, 0, >, 49)                                                                                 /* Stunde 5                                                                                                                                                                                    */  // LED_to_Var(t6, 0, >, 59)                                                                                 /* Stunde 6                                                                                                                                                                                    */  // LED_to_Var(t7, 0, >, 69)                                                                                 /* Stunde 7                                                                                                                                                                                    */  // LED_to_Var(t8, 0, >, 79)                                                                                 /* Stunde 8                                                                                                                                                                                    */  // LED_to_Var(t9, 0, >, 89)                                                                                 /* Stunde 9                                                                                                                                                                                    */  // LED_to_Var(t10, 0, >, 99)                                                                                /* Stunde 10                                                                                                                                                                                   */  // LED_to_Var(t11, 0, >, 109)                                                                               /* Stunde 11                                                                                                                                                                                   */  // LED_to_Var(t12, 0, >, 119)                                                                               /* Stunde 12                                                                                                                                                                                   */  // LED_to_Var(t13, 0, >, 129)                                                                               /* Stunde 13                                                                                                                                                                                   */  // LED_to_Var(t14, 0, >, 139)                                                                               /* Stunde 14                                                                                                                                                                                   */  // LED_to_Var(t15, 0, >, 149)                                                                               /* Stunde 15                                                                                                                                                                                   */  // LED_to_Var(t16, 0, >, 159)                                                                               /* Stunde 16                                                                                                                                                                                   */  // LED_to_Var(t17, 0, >, 169)                                                                               /* Stunde 17                                                                                                                                                                                   */  // LED_to_Var(t18, 0, >, 179)                                                                               /* Stunde 18                                                                                                                                                                                   */  // LED_to_Var(t19, 0, >, 189)                                                                               /* Stunde 19                                                                                                                                                                                   */  // LED_to_Var(t20, 0, >, 199)                                                                               /* Stunde 20                                                                                                                                                                                   */  // LED_to_Var(t21, 0, >, 209)                                                                               /* Stunde 21                                                                                                                                                                                   */  // LED_to_Var(t22, 0, >, 219)                                                                               /* Stunde 22                                                                                                                                                                                   */  // LED_to_Var(t23, 0, >, 229)                                                                               /* Stunde 23                                                                                                                                                                                   */  ConstRGB(2, 1, 0, 0, 0, 0, 127, 127)                                                                        /* Excel row 29                                                                                                                                                                                */  Blinker(3, C3, 2, 1 Sek)                                                                                    /* Excel row 30                                                                                                                                                                                */  // LED_to_Var(BlinkerEin, 2, >, 0)                                                                          /* Excel row 31                                                                                                                                                                                */  RGB_Heartbeat(4)                                                                                            /* Excel row 32                                                                                                                                                                                */  RGB_Heartbeat(5)                                                                                            /* Excel row 33                                                                                                                                                                                */  RGB_Heartbeat(6)                                                                                            /* Excel row 34                                                                                                                                                                                */  RGB_Heartbeat(7)                                                                                            /* Excel row 35                                                                                                                                                                                */  RGB_Heartbeat(8)                                                                                            /* Excel row 36                                                                                                                                                                                */  ConstRGB(9, t1, 0, 0, 0, 32, 32, 32)                                                                        /* Excel row 38                                                                                                                                                                                */  ConstRGB(10, t2, 0, 0, 0, 32, 32, 32)                                                                       /* Excel row 39                                                                                                                                                                                */  ConstRGB(11, t3, 0, 0, 0, 32, 32, 32)                                                                       /* Excel row 40                                                                                                                                                                                */  ConstRGB(12, t4, 0, 0, 0, 32, 32, 32)                                                                       /* Excel row 41                                                                                                                                                                                */  ConstRGB(13, t5, 0, 0, 0, 32, 32, 32)                                                                       /* Excel row 42                                                                                                                                                                                */  ConstRGB(14, t6, 0, 0, 0, 32, 32, 32)                                                                       /* Excel row 43                                                                                                                                                                                */  ConstRGB(15, t7, 0, 0, 0, 32, 32, 32)                                                                       /* Excel row 44                                                                                                                                                                                */  ConstRGB(16, t8, 0, 0, 0, 32, 32, 32)                                                                       /* Excel row 45                                                                                                                                                                                */  ConstRGB(17, t9, 0, 0, 0, 32, 32, 32)                                                                       /* Excel row 46                                                                                                                                                                                */  ConstRGB(18, t10, 0, 0, 0, 32, 32, 32)                                                                      /* Excel row 47                                                                                                                                                                                */  ConstRGB(19, t11, 0, 0, 0, 32, 32, 32)                                                                      /* Excel row 48                                                                                                                                                                                */  ConstRGB(20, t12, 0, 0, 0, 32, 32, 32)                                                                      /* Excel row 49                                                                                                                                                                                */  ConstRGB(21, t13, 0, 0, 0, 32, 32, 32)                                                                      /* Excel row 50                                                                                                                                                                                */  ConstRGB(22, t14, 0, 0, 0, 32, 32, 32)                                                                      /* Excel row 51                                                                                                                                                                                */  ConstRGB(23, t15, 0, 0, 0, 32, 32, 32)                                                                      /* Excel row 52                                                                                                                                                                                */  ConstRGB(24, t16, 0, 0, 0, 32, 32, 32)                                                                      /* Excel row 53                                                                                                                                                                                */  ConstRGB(25, t17, 0, 0, 0, 32, 32, 32)                                                                      /* Excel row 54                                                                                                                                                                                */  ConstRGB(26, t18, 0, 0, 0, 32, 32, 32)                                                                      /* Excel row 55                                                                                                                                                                                */  ConstRGB(27, t19, 0, 0, 0, 32, 32, 32)                                                                      /* Excel row 56                                                                                                                                                                                */  ConstRGB(28, t20, 0, 0, 0, 32, 32, 32)                                                                      /* Excel row 57                                                                                                                                                                                */  ConstRGB(29, t21, 0, 0, 0, 32, 32, 32)                                                                      /* Excel row 58                                                                                                                                                                                */  ConstRGB(30, t22, 0, 0, 0, 32, 32, 32)                                                                      /* Excel row 59                                                                                                                                                                                */  ConstRGB(31, t23, 0, 0, 0, 32, 32, 32)                                                                      /* Excel row 60                                                                                                                                                                                */  // Reserve LEDs(1)                                                                                          /* Excel row 61                                                                                                                                                                                */  Logic(h18bis23, t18 AND NOT t23)                                                                            /* Excel row 62                                                                                                                                                                                */  AndreaskrRGB(33, h18bis23)                                                                                  /* Excel row 63                                                                                                                                                                                */  Logic(h22bis03, t22 OR NOT t3)                                                                              /* Excel row 64                                                                                                                                                                                */  ConstrWarnLightRGB6(35, h22bis03, 5, 255, 100 ms, 0 ms, 500 ms)                                             /* Excel row 65                                                                                                                                                                                */  Logic(h06bis09, t6 AND NOT t9)                                                                              /* Excel row 66                                                                                                                                                                                */  WeldingCont(41, h06bis09)                                                                                   /* Excel row 67                                                                                                                                                                                */  #define ENABLE_STORE_STATUS                                                                                 /* Excel row 69                                                                                                                                                                                */  #define USE_SWITCH_AND_LED_ARRAY                                                                            /* Excel row 70                                                                                                                                                                                */  #define WIFI                                                                                                /* Excel row 71                                                                                                                                                                                */  #define Mainboard_LED1  BlinkerEin                                                                          /* Excel row 84                                                                                                                                                                                */  #define Mainboard_LED2  BlinkerEin                                                                          /* Excel row 85                                                                                                                                                                                */  #define Mainboard_LED3  BlinkerEin                                                                          /* Excel row 86                                                                                                                                                                                */  RandMux(rand1, rand8, SI_1, RM_NORMAL, 50, 250)                                                             /* Excel row 88                                                                                                                                                                                */  ConstRGB(42, rand1, 0, 0, 0, 0, 64, 64)                                                                     /* Excel row 89                                                                                                                                                                                */  ConstRGB(43, rand2, 0, 0, 0, 0, 64, 64)                                                                     /* Excel row 90                                                                                                                                                                                */  ConstRGB(44, rand3, 0, 0, 0, 0, 64, 64)                                                                     /* Excel row 91                                                                                                                                                                                */  ConstRGB(45, rand4, 0, 0, 0, 0, 64, 64)                                                                     /* Excel row 92                                                                                                                                                                                */  ConstRGB(46, rand5, 0, 0, 0, 0, 64, 64)                                                                     /* Excel row 93                                                                                                                                                                                */  ConstRGB(47, rand6, 0, 0, 0, 0, 64, 64)                                                                     /* Excel row 94                                                                                                                                                                                */  ConstRGB(48, rand7, 0, 0, 0, 0, 64, 64)                                                                     /* Excel row 95                                                                                                                                                                                */  ConstRGB(49, rand8, 0, 0, 0, 0, 64, 64)                                                                     /* Excel row 96                                                                                                                                                                                */
  EndCfg // End of the configuration
  };
//*******************************************************************

//---------------------------------------------
void Set_Start_Values(MobaLedLib_C &MobaLedLib)
//---------------------------------------------
{
}


// if function returns TRUE the calling loop stops
typedef bool(*HandleValue_t) (uint8_t CallbackType, uint8_t ValueId, uint8_t* Value, uint16_t EEPromAddr, uint8_t TargetValueId, uint8_t Options);


#define InCnt_MSK  0x0007  // 3 Bits are used for the InCnt
#define IS_COUNTER (uint8_t)0x80
#define IS_PULSE   (uint8_t)0x40
#define IS_TOGGLE  (uint8_t)0x00
#define COUNTER_ID

typedef struct
    {
    uint8_t TypAndInCnt; // Type bit 7, InCnt bits 0..3, reserved 0 bits 4..6
    uint8_t Channel;
    } __attribute__ ((packed)) Store_Channel_T;

// Definition of channels and counters that need to store state in EEPromconst PROGMEM Store_Channel_T Store_Values[] =         { // Mode + InCnt , Channel
           { IS_TOGGLE + 1 , INCH_DCC_23_ONOFF   },      // Excel row 29           { IS_TOGGLE + 1 , INCH_DCC_24_ONOFF   },      // Excel row 30         };






#endif // __LEDS_AUTOPROG_H__
