// This file contains the DCC and LED definitions.
//
// It was automatically generated by the program Prog_Generator_MobaLedLib.xlsm Ver. 3.1.0A      by Hardi
// File creation: 20.12.2021 11:54:22
// (Attention: The display in the Arduino IDE is not updated if Options/External Editor is disabled)

#ifndef __LEDS_AUTOPROG_H__
#define __LEDS_AUTOPROG_H__

#ifndef ARDUINO_RASPBERRY_PI_PICO
#define FASTLED_INTERNAL       // Disable version number message in FastLED library (looks like an error)
#include <FastLED.h>           // The FastLED library must be installed in addition if you got the error message "..fatal error: FastLED.h: No such file or directory"
                               // Arduino IDE: Sketch / Include library / Manage libraries                    Deutsche IDE: Sketch / Bibliothek einbinden / Bibliothek verwalten
                               //              Type "FastLED" in the "Filter your search..." field                          "FastLED" in das "Grenzen Sie ihre Suche ein" Feld eingeben
                               //              Select the entry and click "Install"                                         Gefundenen Eintrag auswaehlen und "Install" anklicken
#else
#include <PicoFastLED.h>       // Juergens minimum version or FastLED for Raspberry Pico
#endif

#include <MobaLedLib.h>

#define START_MSG "LEDs_AutoProg Ver 1: Ver_3.1.0 20.12.21 11:54"

#define TWO_BUTTONS_PER_ADDRESS 1      // Two buttons (Red/Green) are used (DCC/CAN)
#ifdef NUM_LEDS
  #warning "'NUM_LEDS' definition in the main program is replaced by the included 'LEDs_AutoProg.h' with 20"
  #undef NUM_LEDS
#endif

#define NUM_LEDS 20                    // Number of LEDs (Maximal 256 RGB LEDs could be used)

#define LEDS_PER_CHANNEL ",10,9,1"

#define RECEIVE_LED_COLOR_PER_RS232
#define USE_EXT_ADDR
#define USE_RS232_OR_SPI_AS_INPUT      // Use the RS232 or SPI Input to read DCC/SX commands from the second Arduino and from the PC (The SPI is only used if enabled with USE_SPI_COM)
#define ADDR_OFFSET 0

#define ADDR_MSK  0x3FFF  // 14 Bits are used for the Address

#define S_ONOFF   (uint16_t)0
#define B_RED     (uint16_t)(1<<14)
#define B_GREEN   (uint16_t)(2<<14)
#define B_RESERVE (uint16_t)(3<<14)    // Not used at the moment
#define B_TAST    B_RED


typedef struct
    {
    uint16_t AddrAndTyp; // Addr range: 0..16383. The upper two bytes are used for the type
    uint8_t  InCnt;
    } __attribute__ ((packed)) Ext_Addr_T;

// Definition of external adressesconst PROGMEM Ext_Addr_T Ext_Addr[] =         { // Addr & Typ    InCnt
           { 10   + B_RED,   16},      // DimmerC1 (pc)           { 20   + B_RED,   16},      // DimmerC2 (pc)           { 30   + B_RED,   16},      // DimmerC3 (pc)           { 100  + S_ONOFF, 1 },      // Excel row 12           { 101  + S_ONOFF, 1 },      // Excel row 13           { 102  + S_ONOFF, 1 },      // Excel row 14           { 103  + S_ONOFF, 1 },      // Excel row 15           { 201  + S_ONOFF, 1 },      // Excel row 17           { 202  + S_ONOFF, 1 },      // Excel row 18           { 203  + S_ONOFF, 1 },      // Excel row 19           { 204  + S_ONOFF, 1 },      // Excel row 20           { 205  + S_ONOFF, 1 },      // Excel row 21           { 206  + S_ONOFF, 1 },      // Excel row 22           { 207  + S_ONOFF, 1 },      // Excel row 23           { 208  + S_ONOFF, 1 },      // Excel row 24           { 209  + S_ONOFF, 1 },      // Excel row 25         };


// Input channel defines for local inputs and expert users
#define INCH_DCC_10_RED         0      // DimmerC1 (pc)#define INCH_DCC_10_GREEN       1      //     "#define INCH_DCC_11_RED         2      //     "#define INCH_DCC_11_GREEN       3      //     "#define INCH_DCC_12_RED         4      //     "#define INCH_DCC_12_GREEN       5      //     "#define INCH_DCC_13_RED         6      //     "#define INCH_DCC_13_GREEN       7      //     "#define INCH_DCC_14_RED         8      //     "#define INCH_DCC_14_GREEN       9      //     "#define INCH_DCC_15_RED         10     //     "#define INCH_DCC_15_GREEN       11     //     "#define INCH_DCC_16_RED         12     //     "#define INCH_DCC_16_GREEN       13     //     "#define INCH_DCC_17_RED         14     //     "#define INCH_DCC_17_GREEN       15     //     "#define INCH_DCC_20_RED         16     // DimmerC2 (pc)#define INCH_DCC_20_GREEN       17     //     "#define INCH_DCC_21_RED         18     //     "#define INCH_DCC_21_GREEN       19     //     "#define INCH_DCC_22_RED         20     //     "#define INCH_DCC_22_GREEN       21     //     "#define INCH_DCC_23_RED         22     //     "#define INCH_DCC_23_GREEN       23     //     "#define INCH_DCC_24_RED         24     //     "#define INCH_DCC_24_GREEN       25     //     "#define INCH_DCC_25_RED         26     //     "#define INCH_DCC_25_GREEN       27     //     "#define INCH_DCC_26_RED         28     //     "#define INCH_DCC_26_GREEN       29     //     "#define INCH_DCC_27_RED         30     //     "#define INCH_DCC_27_GREEN       31     //     "#define INCH_DCC_30_RED         32     // DimmerC3 (pc)#define INCH_DCC_30_GREEN       33     //     "#define INCH_DCC_31_RED         34     //     "#define INCH_DCC_31_GREEN       35     //     "#define INCH_DCC_32_RED         36     //     "#define INCH_DCC_32_GREEN       37     //     "#define INCH_DCC_33_RED         38     //     "#define INCH_DCC_33_GREEN       39     //     "#define INCH_DCC_34_RED         40     //     "#define INCH_DCC_34_GREEN       41     //     "#define INCH_DCC_35_RED         42     //     "#define INCH_DCC_35_GREEN       43     //     "#define INCH_DCC_36_RED         44     //     "#define INCH_DCC_36_GREEN       45     //     "#define INCH_DCC_37_RED         46     //     "#define INCH_DCC_37_GREEN       47     //     "#define INCH_DCC_100_ONOFF      48     // Excel row 12#define INCH_DCC_101_ONOFF      49     // Excel row 13#define INCH_DCC_102_ONOFF      50     // Excel row 14#define INCH_DCC_103_ONOFF      51     // Excel row 15#define INCH_DCC_201_ONOFF      52     // Excel row 17#define INCH_DCC_202_ONOFF      53     // Excel row 18#define INCH_DCC_203_ONOFF      54     // Excel row 19#define INCH_DCC_204_ONOFF      55     // Excel row 20#define INCH_DCC_205_ONOFF      56     // Excel row 21#define INCH_DCC_206_ONOFF      57     // Excel row 22#define INCH_DCC_207_ONOFF      58     // Excel row 23#define INCH_DCC_208_ONOFF      59     // Excel row 24#define INCH_DCC_209_ONOFF      60     // Excel row 25

/*********************/
#define SETUP_FASTLED()                                                      \
/*********************/                                                      \
  CLEDController& controller0 = FastLED.addLeds<NEOPIXEL,  6>(leds+  0, 10); \
  CLEDController& controller1 = FastLED.addLeds<NEOPIXEL, A4>(leds+ 10,  9); \
                                                                             \
  controller0.clearLeds(256);                                                \
  controller1.clearLeds(256);                                                \
  FastLED.setDither(DISABLE_DITHER);       // avoid sending slightly modified brightness values
/*End*/

#include "DmxInterface.h"     // DMX512 Interface
#define USE_DMX_PIN 2
#define DMX_LED_OFFSET 19
#define DMX_CHANNEL_COUNT 3
DMXInterface dmxInterface;


//*******************************************************************
// *** Configuration array which defines the behavior of the LEDs ***
MobaLedLib_Configuration()
  {
  RGB_Heartbeat(0)                                                                                            /* Excel row 3                                                                                                                                                                                 */  // Set_LED_OutpPinLst(6 A4 2)                                                                               /* Excel row 4                                                                                                                                                                                 */  // Use_DMX512()                                                                                             /* Excel row 5                                                                                                                                                                                 */  // Activation: N_Buttons                                                                                    /* DimmerC1 (pc)                                                                                                                                                                               */  InCh_to_TmpVar(0, 16)                                                                                       /*     "                                                                                                                                                                                       */  PatternT1(19,12,SI_LocalVar,1,0,255,0,0,0,16,50,84,118,152,186,220,254  ,63,191,191,191,191,191,191,191,191,191,191,191,191,191,191,191) /*     "                                                                                                                                                          */  // Activation: N_Buttons                                                                                    /* DimmerC2 (pc)                                                                                                                                                                               */  InCh_to_TmpVar(16, 16)                                                                                      /*     "                                                                                                                                                                                       */  PatternT1(19,13,SI_LocalVar,1,0,255,0,0,0,16,50,84,118,152,186,220,254  ,63,191,191,191,191,191,191,191,191,191,191,191,191,191,191,191) /*     "                                                                                                                                                          */  // Activation: N_Buttons                                                                                    /* DimmerC3 (pc)                                                                                                                                                                               */  InCh_to_TmpVar(32, 16)                                                                                      /*     "                                                                                                                                                                                       */  PatternT1(19,14,SI_LocalVar,1,0,255,0,0,0,16,50,84,118,152,186,220,254  ,63,191,191,191,191,191,191,191,191,191,191,191,191,191,191,191) /*     "                                                                                                                                                          */  ConstRGB(1, 48, 0, 0, 0, 127, 127, 127)                                                                     /* Excel row 12                                                                                                                                                                                */  ConstRGB(2, 49, 0, 0, 0, 127, 127, 127)                                                                     /* Excel row 13                                                                                                                                                                                */  ConstRGB(3, 50, 0, 0, 0, 127, 127, 127)                                                                     /* Excel row 14                                                                                                                                                                                */  ConstRGB(4, 51, 0, 0, 0, 127, 127, 127)                                                                     /* Excel row 15                                                                                                                                                                                */  Blinker(10, C_ALL, 52, 1 Sek)                                                                               /* Excel row 17                                                                                                                                                                                */  Blinker(11, C_ALL, 53, 1 Sek)                                                                               /* Excel row 18                                                                                                                                                                                */  Blinker(12, C_ALL, 54, 1 Sek)                                                                               /* Excel row 19                                                                                                                                                                                */  Blinker(13, C_ALL, 55, 1 Sek)                                                                               /* Excel row 20                                                                                                                                                                                */  Blinker(14, C_ALL, 56, 1 Sek)                                                                               /* Excel row 21                                                                                                                                                                                */  Blinker(15, C_ALL, 57, 1 Sek)                                                                               /* Excel row 22                                                                                                                                                                                */  Blinker(16, C_ALL, 58, 1 Sek)                                                                               /* Excel row 23                                                                                                                                                                                */  Blinker(17, C_ALL, 59, 1 Sek)                                                                               /* Excel row 24                                                                                                                                                                                */  Blinker(18, C_ALL, 60, 1 Sek)                                                                               /* Excel row 25                                                                                                                                                                                */
  EndCfg // End of the configuration
  };
//*******************************************************************

//---------------------------------------------
void Set_Start_Values(MobaLedLib_C &MobaLedLib)
//---------------------------------------------
{
}


// if function returns TRUE the calling loop stops
typedef bool(*HandleValue_t) (uint8_t CallbackType, uint8_t ValueId, uint8_t* Value, uint16_t EEPromAddr, uint8_t TargetValueId, uint8_t Options);


#define InCnt_MSK  0x0007  // 3 Bits are used for the InCnt
#define IS_COUNTER (uint8_t)0x80
#define IS_PULSE   (uint8_t)0x40
#define IS_TOGGLE  (uint8_t)0x00
#define COUNTER_ID

typedef struct
    {
    uint8_t TypAndInCnt; // Type bit 7, InCnt bits 0..3, reserved 0 bits 4..6
    uint8_t Channel;
    } __attribute__ ((packed)) Store_Channel_T;

// Definition of channels and counters that need to store state in EEPromconst PROGMEM Store_Channel_T Store_Values[] =         { // Mode + InCnt , Channel
           { IS_PULSE  + 16, INCH_DCC_10_RED     },      // DimmerC1 (pc)           { IS_PULSE  + 16, INCH_DCC_20_RED     },      // DimmerC2 (pc)           { IS_PULSE  + 16, INCH_DCC_30_RED     },      // DimmerC3 (pc)           { IS_TOGGLE + 1 , INCH_DCC_100_ONOFF  },      // Excel row 12           { IS_TOGGLE + 1 , INCH_DCC_101_ONOFF  },      // Excel row 13           { IS_TOGGLE + 1 , INCH_DCC_102_ONOFF  },      // Excel row 14           { IS_TOGGLE + 1 , INCH_DCC_103_ONOFF  },      // Excel row 15           { IS_TOGGLE + 1 , INCH_DCC_201_ONOFF  },      // Excel row 17           { IS_TOGGLE + 1 , INCH_DCC_202_ONOFF  },      // Excel row 18           { IS_TOGGLE + 1 , INCH_DCC_203_ONOFF  },      // Excel row 19           { IS_TOGGLE + 1 , INCH_DCC_204_ONOFF  },      // Excel row 20           { IS_TOGGLE + 1 , INCH_DCC_205_ONOFF  },      // Excel row 21           { IS_TOGGLE + 1 , INCH_DCC_206_ONOFF  },      // Excel row 22           { IS_TOGGLE + 1 , INCH_DCC_207_ONOFF  },      // Excel row 23           { IS_TOGGLE + 1 , INCH_DCC_208_ONOFF  },      // Excel row 24           { IS_TOGGLE + 1 , INCH_DCC_209_ONOFF  },      // Excel row 25         };






#endif // __LEDS_AUTOPROG_H__
